id: PYSEC-0000-CVE-2023-36811
severity:
- type: CVSS_V3
  score: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:N/I:H/A:N
details: 'borgbackup is an opensource, deduplicating archiver with compression and
  authenticated encryption. A flaw in the cryptographic authentication scheme in borgbackup
  allowed an attacker to fake archives and potentially indirectly cause backup data
  loss in the repository. The attack requires an attacker to be able to: 1. insert
  files (with no additional headers) into backups and 2. gain write access to the
  repository. This vulnerability does not disclose plaintext to the attacker, nor
  does it affect the authenticity of existing archives. Creating plausible fake archives
  may be feasible for empty or small archives, but is unlikely for large archives.
  The issue has been fixed in borgbackup 1.2.5. Users are advised to upgrade. Additionally
  to installing the fixed code, users must follow the upgrade procedure as documented
  in the change log. Data loss after being attacked can be avoided by reviewing the
  archives (timestamp and contents valid and as expected) after any "borg check --repair"
  and before "borg prune". There are no known workarounds for this vulnerability.'
affected:
- package:
    name: borgbackup
    ecosystem: PyPI
    purl: pkg:pypi/borgbackup
  ranges:
  - type: GIT
    repo: https://github.com/borgbackup/borg
    events:
    - introduced: "0"
    - fixed: 3eb070191da10c2d3f7bc6484cf3d51c3045f884
  - type: ECOSYSTEM
    events:
    - introduced: "0"
    - fixed: 1.2.5
references:
- type: WEB
  url: https://github.com/borgbackup/borg/blob/1.2.5-cvedocs/docs/changes.rst#pre-125-archives-spoofing-vulnerability-cve-2023-36811
- type: FIX
  url: https://github.com/borgbackup/borg/commit/3eb070191da10c2d3f7bc6484cf3d51c3045f884
- type: ADVISORY
  url: https://github.com/borgbackup/borg/security/advisories/GHSA-8fjr-hghr-4m99
aliases:
- CVE-2023-36811
- GHSA-8fjr-hghr-4m99
modified: "2023-09-06T14:23:00Z"
published: "2023-08-30T18:15:00Z"
