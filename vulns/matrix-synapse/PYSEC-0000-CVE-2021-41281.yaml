id: PYSEC-0000-CVE-2021-41281
details: Synapse is a package for Matrix homeservers written in Python 3/Twisted.
  Prior to version 1.47.1, Synapse instances with the media repository enabled can
  be tricked into downloading a file from a remote server into an arbitrary directory.
  No authentication is required for the affected endpoint. The last 2 directories
  and file name of the path are chosen randomly by Synapse and cannot be controlled
  by an attacker, which limits the impact. Homeservers with the media repository disabled
  are unaffected. Homeservers with a federation whitelist are also unaffected, since
  Synapse will check the remote hostname, including the trailing `../`s, against the
  whitelist. Server administrators should upgrade to 1.47.1 or later. Server administrators
  using a reverse proxy could, at the expense of losing media functionality, may block
  the certain endpoints as a workaround. Alternatively, non-containerized deployments
  can be adapted to use the hardened systemd config.
affected:
- package:
    name: matrix-synapse
    ecosystem: PyPI
    purl: pkg:pypi:matrix-synapse
  ranges:
  - type: GIT
    repo: https://github.com/matrix-org/synapse
    events:
    - introduced: "0"
    - fixed: 91f2bd090
  - type: ECOSYSTEM
    events:
    - introduced: "0"
    - fixed: 1.47.1
references:
- type: WEB
  url: https://github.com/matrix-org/synapse/releases/tag/v1.47.1
- type: ADVISORY
  url: https://github.com/matrix-org/synapse/security/advisories/GHSA-3hfw-x7gx-437c
- type: FIX
  url: https://github.com/matrix-org/synapse/commit/91f2bd090
aliases:
- CVE-2021-41281
- GHSA-3hfw-x7gx-437c
modified: "2021-11-29T14:49:00Z"
published: "2021-11-23T20:15:00Z"
