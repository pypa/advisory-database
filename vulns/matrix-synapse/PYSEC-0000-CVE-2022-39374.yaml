id: PYSEC-0000-CVE-2022-39374
details: |+
  Synapse is an open-source Matrix homeserver written and maintained by the Matrix.org Foundation. If Synapse and a malicious homeserver are both joined to the same room, the malicious homeserver can trick Synapse into accepting previously rejected events into its view of the current state of that room. This can be exploited in a way that causes all further messages and state changes sent in that room from the vulnerable homeserver to be rejected. This issue has been patched in version 1.68.0

aliases:
- CVE-2022-39374
- GHSA-p9qp-c452-f9r7
modified: '2023-06-05T01:12:54.698222Z'
published: '2023-05-26T14:15:00Z'
references:
- type: REPORT
  url: https://github.com/matrix-org/synapse/pull/13723
- type: FIX
  url: https://github.com/matrix-org/synapse/pull/13723
- type: ADVISORY
  url: https://github.com/matrix-org/synapse/security/advisories/GHSA-p9qp-c452-f9r7
affected:
- package:
    name: matrix-synapse
    ecosystem: PyPI
    purl: pkg:pypi/matrix-synapse
  ranges:
  - type: ECOSYSTEM
    events:
    - introduced: 1.62.0
    - fixed: 1.68.0
  versions:
  - 1.62.0
  - 1.63.0
  - 1.63.0rc1
  - 1.63.1
  - 1.64.0
  - 1.64.0rc1
  - 1.64.0rc2
  - 1.65.0
  - 1.65.0rc1
  - 1.65.0rc2
  - 1.66.0
  - 1.66.0rc1
  - 1.66.0rc2
  - 1.67.0
  - 1.67.0rc1
  - 1.68.0rc1
  - 1.68.0rc2
