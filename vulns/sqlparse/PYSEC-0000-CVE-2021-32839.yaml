id: PYSEC-0000-CVE-2021-32839
details: sqlparse is a non-validating SQL parser module for Python. In sqlparse versions
  0.4.0 and 0.4.1 there is a regular Expression Denial of Service in sqlparse vulnerability.
  The regular expression may cause exponential backtracking on strings containing
  many repetitions of '\r\n' in SQL comments. Only the formatting feature that removes
  comments from SQL statements is affected by this regular expression. As a workaround
  don't use the sqlformat.format function with keyword strip_comments=True or the
  --strip-comments command line flag when using the sqlformat command line tool. The
  issues has been fixed in sqlparse 0.4.2.
affected:
- package:
    name: sqlparse
    ecosystem: PyPI
  ranges:
  - type: GIT
    repo: https://github.com/andialbrecht/sqlparse
    events:
    - fixed: 8238a9e450ed1524e40cb3a8b0b3c00606903aeb
  - type: ECOSYSTEM
    events:
    - introduced: "0"
    - fixed: 0.4.2
references:
- type: WEB
  url: https://github.com/andialbrecht/sqlparse/commit/8238a9e450ed1524e40cb3a8b0b3c00606903aeb
- type: WEB
  url: https://github.com/andialbrecht/sqlparse/security/advisories/GHSA-p5w8-wqhj-9hhf
aliases:
- CVE-2021-32839
modified: "2021-09-20T18:15:00Z"
published: "2021-09-20T17:15:00Z"
