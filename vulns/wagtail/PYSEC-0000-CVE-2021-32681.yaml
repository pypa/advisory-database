id: PYSEC-0000-CVE-2021-32681
package:
  name: wagtail
  ecosystem: PyPI
details: Wagtail is an open source content management system built on Django. A cross-site
  scripting vulnerability exists in versions 2.13-2.13.1, versions 2.12-2.12.4, and
  versions prior to 2.11.8. When the `{% include_block %}` template tag is used to
  output the value of a plain-text StreamField block (`CharBlock`, `TextBlock` or
  a similar user-defined block derived from `FieldBlock`), and that block does not
  specify a template for rendering, the tag output is not properly escaped as HTML.
  This could allow users to insert arbitrary HTML or scripting. This vulnerability
  is only exploitable by users with the ability to author StreamField content (i.e.
  users with 'editor' access to the Wagtail admin). Patched versions have been released
  as Wagtail 2.11.8 (for the LTS 2.11 branch), Wagtail 2.12.5, and Wagtail 2.13.2
  (for the current 2.13 branch). As a workaround, site implementors who are unable
  to upgrade to a current supported version should audit their use of `{% include_block
  %}` to ensure it is not used to output `CharBlock` / `TextBlock` values with no
  associated template. Note that this only applies where `{% include_block %}` is
  used directly on that block (uses of `include_block` on a block _containing_ a CharBlock
  / TextBlock, such as a StructBlock, are unaffected). In these cases, the tag can
  be replaced with Django's `{{ ... }}` syntax - e.g. `{% include_block my_title_block
  %}` becomes `{{ my_title_block }}`.
affects:
  ranges:
  - type: ECOSYSTEM
    introduced: "2.13"
    fixed: 2.13.2
  - type: ECOSYSTEM
    introduced: "2.12"
    fixed: 2.12.5
  - type: ECOSYSTEM
    fixed: 2.11.8
references:
- type: WEB
  url: https://github.com/wagtail/wagtail/releases/tag/v2.11.8
- type: WEB
  url: https://github.com/wagtail/wagtail/releases/tag/v2.12.5
- type: WEB
  url: https://github.com/wagtail/wagtail/security/advisories/GHSA-xfrw-hxr5-ghqf
- type: WEB
  url: https://github.com/wagtail/wagtail/releases/tag/v2.13.2
aliases:
- CVE-2021-32681
modified: "2021-06-17T19:52:00Z"
published: "2021-06-17T17:15:00Z"